---
- name: Install Core Packages
  package:
    name:
    - asdf
    # Update latest bash
    - bash
    - bash-completion@2
    - cmake
    # Install GNU core utilities (those that come with macOS are outdated).
    # Donâ€™t forget to add `$(brew --prefix coreutils)/libexec/gnubin` to `$PATH`.
    - coreutils
    - ffmpeg
    - gh
    - gifsicle
    - git
    - git-lfs
    - git-secrets
    - gnupg
    - grep
    - jq
    - k9s
    - mas
    - openssh
    - openssl
    - postgresql
    - shellcheck
    - vim
    # update latest zsh
    - zsh
    - zsh-completions
    state: latest
  register: updated_packages
  tags:
  - core
  - install
  - essential
- name: Get the path to Bash
  local_action: command which bash
  register: bash_path
  tags:
  - core
  - install
  - productivity
  - essential

- name: "Ensure homebrew bash is in allowed shells"
  lineinfile:
    path: /etc/shells
    line: "{{ bash_path.stdout }}"
  become: yes
  tags:
  - core
  - install
  - productivity
  - essential

- name: Get the path to ZSH
  local_action: command which zsh
  register: zsh_path
  tags:
  - core
  - install
  - productivity
  - essential

- name: "Ensure homebrew zsh is in allowed shells"
  lineinfile:
    path: /etc/shells
    line: "{{ zsh_path.stdout }}"
  become: yes
  tags:
  - core
  - install
  - productivity
  - essential
