---
- name: Install Core Packages
  package:
    name:
    - asdf
    # Update latest bash
    - bash
    - bash-completion@2
    - cmake
    # Install GNU core utilities (those that come with macOS are outdated).
    # Donâ€™t forget to add `$(brew --prefix coreutils)/libexec/gnubin` to `$PATH`.
    - coreutils
    - ffmpeg
    - gh
    - gifsicle
    - git
    - git-lfs
    - git-secrets
    - gnupg
    - grep
    - jq
    - k9s
    - mas
    - openssh
    - openssl
    - shellcheck
    - vim
    # update latest zsh
    - zsh
    - zsh-completions
    state: latest

- name: Get the path to Bash
  become: false
  local_action: command which bash
  register: bash_path

- name: "Ensure homebrew bash is in allowed shells"
  lineinfile:
    path: /etc/shells
    line: "{{ bash_path.stdout }}"
  become: true

- name: Get the path to ZSH
  become: false
  local_action: command which zsh
  register: zsh_path

- name: "Ensure homebrew zsh is in allowed shells"
  lineinfile:
    path: /etc/shells
    line: "{{ zsh_path.stdout }}"
  become: true
